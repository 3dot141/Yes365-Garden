---
aliases: []
created_date: 2023-08-25 16:00
draft: false
summary: ''
tags:
- dev
---

- [听过多泳道吗？赶紧进来看看它怎么建设的~ - 掘金](https://juejin.cn/post/7109705071151022087)
- [你居然只知道蓝绿发布？今天教你全链路灰度~ - 掘金](https://juejin.cn/post/7109506936868962335)
- 适当时可参考竞品 [什么是微服务引擎MSE](https://help.aliyun.com/document_detail/126761.html)

# 正文

## 全链路灰度

| 灰度方案   | 长什么样                                                             | 优缺点                     |
| ---------- |:----| -------------------------- |
| 蓝绿发布   | 有两套一毛一样的环境，在上线的时候，通过切换不同环境，来达到丝滑上线 | 优点：快捷。缺点：浪费资源 |
| AB Test    | 通过不同的角色或者用户来进入不同逻辑，进行验证                       | 优点：粒度更小             |
| 金丝雀发布 | 通过流量比将流量负载到不同机器                                       | 缺点：灰度粒度比较粗       |

全链路灰度：顾名思义，就是整条调用链路，你想访问哪就访问哪，指哪打哪。我们可以设想想，**蓝绿发布** 是所有应用的灰度，**一刀切**。**AB Test** 是部分用户，**部分切**。**全链路发布**，其实是需要 **细化到服务、接口级别灰度**，而且贯穿整条链路~

### 全链路灰度由什么构成

1. 网关流量染色
2. 网关层负载均衡
3. rpc 层负载均衡
4. 上下文透传
5. 数据隔离（看情况）

## 泳道概念

|说明| 术语 |
| --- |:----|
|泳道|相同版本应用定义的一套隔离环境。只有满足了流控路由规则的请求流量才会路由到对应泳道里的打标应用。每条泳道，和一个标签相对应。泳道组里标签相同的多个应用节点，必定属于同一个泳道。一个应用可以属于多个泳道，一个泳道可以包含多个应用，应用和泳道是多对多的关系。| 
|泳道组|泳道的集合。泳道组的作用主要是为了区分不同团队或不同场景。| 

![615](../../Attachments/4a3ab959c2ed8b233dbd54886e34e023.png)