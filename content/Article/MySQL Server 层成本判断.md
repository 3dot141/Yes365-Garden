---
aliases: []
created_date: 2023-09-04 16:47
draft: false
summary: ''
tags:
- dev
---

#dev/mysql

通过观察优化器的信息，不难发现，使用索引扫描行数约 52w 行，而全表扫描约为 104w 行。

为什么优化器反而认为使用索引的成本比全表扫描还高呢？

因为当 `ct_index(create_time)` 这个普通索引并不包括查询的所有列，因此需要通过 `ct_index` 的索引树找到对应的主键 id ，然后再到 id 的索引树进行数据查询，即回表（通过索引查出主键，再去查数据行），这样成本必然上升。

[MySQL 的聚镞索引](MySQL%20的聚镞索引.md)

[在Mysql中，什么是回表，什么是覆盖索引，索引下推？](https://zhuanlan.zhihu.com/p/401198674)

这里可以回头看查询 1 和查询 2 的数据量占比：

- 查询 1 的数据量占整个表的 60%，回表成本高，因此优化器选择了全表扫描
- 查询 2 的数据量占整个表的 0.02%，因此优化器选择了索引

[技术分享 | 为什么 SELECT 查询选择全表扫描，而不走索引？](https://www.modb.pro/db/114805)